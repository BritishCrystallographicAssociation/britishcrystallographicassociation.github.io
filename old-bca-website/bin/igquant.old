$ WN := WRITE NET_LINK$ WN "<DNETRECMODE>"$ INP := $WWW_ROOT:[BIN]CGI_SYMBOLS$ INP WWW_ FORM_$ TIME = F$TIME()$ YEAR := 'F$EXTRACT(9,2,TIME)'$ INFOFILE = "DKUSER3:[WWW]" + F$EXTRACT(0,2,TIME) + F$EXTRACT(12,2,TIME) - + F$EXTRACT(15,2,TIME) + F$EXTRACT(18,2,TIME) + F$EXTRACT(21,2,TIME) + ".DAT;1"$ INFOFILE := 'F$EDIT(INFOFILE,"COLLAPSE")'$ NERR = 0$! Check most important fields only...$ IF "''FORM_FLD_NSURNAME'" .EQS. "" THEN $ NERR = NERR + 1$ IF "''FORM_FLD_NINSTITUTE'" .EQS. "" THEN $ NERR = NERR + 1$ IF "''FORM_FLD_NZIP'" .EQS. "" THEN $ NERR = NERR + 1$ IF "''FORM_FLD_EMAIL'" .EQS. "" THEN $ NERR = NERR + 1$ IF NERR .NE. 0 THEN $ GOTO 20$ OPEN/WRITE INFO 'INFOFILE'$ WRITE INFO ""$ WRITE INFO "Dear IG-Quant Administrator"$ WRITE INFO ""$ WRITE INFO "This message was generated automatically"$ WRITE INFO ""$ IF "''FORM_FLD_NTITLE'" .NES. "" THEN $ WRITE INFO "Title: ''FORM_FLD_NTITLE'"$ IF "''FORM_FLD_NAME'" .NES. "" THEN $ WRITE INFO "Forename: ''FORM_FLD_NAME'"$ IF "''FORM_FLD_NINITIALS'" .NES. "" THEN $ WRITE INFO "Initials: ''FORM_FLD_NINITIALS'"$ IF "''FORM_FLD_NSURNAME'" .NES. "" THEN $ WRITE INFO "Surname: ''FORM_FLD_NSURNAME'"$ IF "''FORM_FLD_NDEPART'" .NES. "" THEN $ WRITE INFO "Department: ''FORM_FLD_NDEPART'"$ IF "''FORM_FLD_NINSTITUTE'" .NES. "" THEN $ WRITE INFO "Institution: ''FORM_FLD_NINSTITUTE'"$ IF "''FORM_FLD_NBUILDING'" .NES. "" THEN $ WRITE INFO "Address (building): ''FORM_FLD_NBUILDING'"$ IF "''FORM_FLD_NSTREET'" .NES. "" THEN $ WRITE INFO "Address (street): ''FORM_FLD_NSTREET'"$ IF "''FORM_FLD_NTOWN'" .NES. "" THEN $ WRITE INFO "Address (town): ''FORM_FLD_NTOWN'"$ IF "''FORM_FLD_NCOUNTY'" .NES. "" THEN $ WRITE INFO "Address (county/state): ''FORM_FLD_NCOUNTY'"$ IF "''FORM_FLD_NCOUNTRY'" .NES. "" THEN $ WRITE INFO "Address (country): ''FORM_FLD_NCOUNTRY'"$ IF "''FORM_FLD_NZIP'" .NES. "" THEN $ WRITE INFO "Address (post/zip code): ''FORM_FLD_NZIP'"$ IF "''FORM_FLD_EMAIL'" .NES. "" THEN $ WRITE INFO "Email: ''FORM_FLD_EMAIL'"$ WRITE INFO ""$ CLOSE/NOLOG INFO$ MAIL/SUBJECT="IG Quantitative Analysis" 'INFOFILE' "cockcroft@img.cryst.bbk.ac.uk"$ DELETE/NOLOG 'INFOFILE'$ WN "content-type: text/html"$ WN ""$ WN "<HTML>"$ WN "<HEAD>"$ WN "<TITLE>BCA IG Round Robin Quantitative Analysis</TITLE>"$ WN "</HEAD>"$ WN "<BODY BGCOLOR=#FFFFFF TEXT=#000000 ALINK=#FF0000 LINK=#0000FF VLINK=#AA00FF>"$ WN "<CENTER>"$ WN "<A HREF=""/bca/welcome.htm""><IMG SRC=""/bca/images/bcalogo3.gif"" BORDER=0></A>"$ WN "<P><FONT SIZE=+2><B>BCA IG Round Robin Quantitative Analysis</B></FONT><P>"$ WN "Thank you for your interest. Samples will be posted to you shortly."$ WN "</CENTER>"$ WN "</BODY>"$ WN "</HTML>"$ EXIT$!$ 20:$ WN "content-type: text/html"$ WN ""$ WN "<HTML>"$ WN "<HEAD>"$ WN "<TITLE>BCA IG Round Robin Quantitative Analysis</TITLE>"$ WN "</HEAD>"$ WN "<BODY BGCOLOR=#FFFFFF TEXT=#000000 ALINK=#FF0000 LINK=#0000FF VLINK=#AA00FF>"$ WN "<CENTER>"$ WN "<A HREF=""/bca/welcome.htm""><IMG SRC=""/bca/images/bcalogo3.gif"" BORDER=0></A>"$ WN "<P><FONT SIZE=+2><B>BCA IG Round Robin Quantitative Analysis</B></FONT><P>"$ WN "Sorry, but you failed to fill in the form correctly.<P>"$ WN "Use the back button on your browser to return to the form.<P>"$ WN "</CENTER>"$ WN "</BODY>"$ WN "</HTML>"$ EXIT