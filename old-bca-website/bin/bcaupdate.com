$ WN := WRITE NET_LINK$ WN "<DNETRECMODE>"$ INP := $WWW_ROOT:[BIN]CGI_SYMBOLS$ INP WWW_ FORM_$ TIME = F$TIME()$ YEAR := 'F$EXTRACT(9,2,TIME)'$ INFOFILE = "DKUSER3:[WWW]" + F$EXTRACT(0,2,TIME) + F$EXTRACT(12,2,TIME) - + F$EXTRACT(15,2,TIME) + F$EXTRACT(18,2,TIME) + F$EXTRACT(21,2,TIME) + ".DAT;1"$ INFOFILE := 'F$EDIT(INFOFILE,"COLLAPSE")'$ NERR = 0$! Check most important fields only...$ IF "''FORM_FLD_FIRSTNAME'" .EQS. "" THEN $ NERR = NERR + 1$ IF "''FORM_FLD_INITIALS'" .EQS. "" THEN $ NERR = NERR + 1$ IF "''FORM_FLD_SURNAME'" .EQS. "" THEN $ NERR = NERR + 1$ IF "''FORM_FLD_EMAIL'" .EQS. "" THEN $ NERR = NERR + 1$ IF NERR .NE. 0 THEN $ GOTO 20$ OPEN/WRITE INFO 'INFOFILE'$ WRITE INFO ""$ WRITE INFO "Dear BCA Administrator"$ WRITE INFO ""$ WRITE INFO "This message was generated automatically when the named member"$ WRITE INFO "updated their BCA membership details via the BCA website."$ WRITE INFO "Items marked compulsory are indicated by (*)."$ WRITE INFO ""$ WRITE INFO "Please can you update your database accordingly."$ WRITE INFO ""$ WRITE INFO "EXISTING DETAILS"$ WRITE INFO "First name: (*) ''FORM_FLD_FIRSTNAME'"$ WRITE INFO "Initials: (*) ''FORM_FLD_INITIALS'"$ WRITE INFO "Surname: (*) ''FORM_FLD_SURNAME'"$ IF "''FORM_FLD_MEMBERNO'" .NES. "" THEN $ WRITE INFO "Membership No.: ''FORM_FLD_MEMBERNO'"$ IF "''FORM_FLD_MEMBERNO'" .EQS. "" THEN $ WRITE INFO "Membership No.: Not Known"$ WRITE INFO ""$ WRITE INFO "EXISTING/NEW DETAILS"$ WRITE INFO "E-mail address: (*) ''FORM_FLD_EMAIL'"$ WRITE INFO ""$ WRITE INFO "NEW DETAILS"$ IF "''FORM_FLD_NTITLE'" .NES. "" THEN $ WRITE INFO "Title: ''FORM_FLD_NTITLE'"$ IF "''FORM_FLD_NTITLE'" .EQS. "" THEN $ WRITE INFO "Title: [No change)"$ IF "''FORM_FLD_NINITIALS'" .NES. "" THEN $ WRITE INFO "Initials: ''FORM_FLD_NINITIALS'"$ IF "''FORM_FLD_NINITIALS'" .EQS. "" THEN $ WRITE INFO "Initials: [No change)"$ IF "''FORM_FLD_NSURNAME'" .NES. "" THEN $ WRITE INFO "Surname: ''FORM_FLD_NSURNAME'"$ IF "''FORM_FLD_NSURNAME'" .EQS. "" THEN $ WRITE INFO "Surname: [No change]"$ IF "''FORM_FLD_NDEPART'" .NES. "" THEN $ WRITE INFO "Department: ''FORM_FLD_NDEPART'"$ IF "''FORM_FLD_NDEPART'" .EQS. "" THEN $ WRITE INFO "Department: [No change]"$ IF "''FORM_FLD_NINSTITUTE'" .NES. "" THEN $ WRITE INFO "Institution: ''FORM_FLD_NINSTITUTE'"$ IF "''FORM_FLD_NINSTITUTE'" .EQS. "" THEN $ WRITE INFO "Institution: [No change]"$ IF "''FORM_FLD_NBUILDING'" .NES. "" THEN $ WRITE INFO "Address (building): ''FORM_FLD_NBUILDING'"$ IF "''FORM_FLD_NBUILDING'" .EQS. "" THEN $ WRITE INFO "Address (building): [No change]"$ IF "''FORM_FLD_NSTREET'" .NES. "" THEN $ WRITE INFO "Address (street): ''FORM_FLD_NSTREET'"$ IF "''FORM_FLD_NSTREET'" .EQS. "" THEN $ WRITE INFO "Address (street): [No change]"$ IF "''FORM_FLD_NTOWN'" .NES. "" THEN $ WRITE INFO "Address (town): ''FORM_FLD_NTOWN'"$ IF "''FORM_FLD_NTOWN'" .EQS. "" THEN $ WRITE INFO "Address (town): [No change]"$ IF "''FORM_FLD_NCOUNTY'" .NES. "" THEN $ WRITE INFO "Address (county/state): ''FORM_FLD_NCOUNTY'"$ IF "''FORM_FLD_NCOUNTY'" .EQS. "" THEN $ WRITE INFO "Address (county/state): [No change]"$ IF "''FORM_FLD_NCOUNTRY'" .NES. "" THEN $ WRITE INFO "Address (country): ''FORM_FLD_NCOUNTRY'"$ IF "''FORM_FLD_NCOUNTRY'" .EQS. "" THEN $ WRITE INFO "Address (country): [No change]"$ IF "''FORM_FLD_NZIP'" .NES. "" THEN $ WRITE INFO "Address (post/zip code): ''FORM_FLD_NZIP'"$ IF "''FORM_FLD_NZIP'" .EQS. "" THEN $ WRITE INFO "Address (post/zip code): [No change]"$ IF "''FORM_FLD_NPHONE'" .NES. "" THEN $ WRITE INFO "Telephone: ''FORM_FLD_NPHONE'"$ IF "''FORM_FLD_NPHONE'" .EQS. "" THEN $ WRITE INFO "Telephone: [No change]"$ IF "''FORM_FLD_NFAX'" .NES. "" THEN $ WRITE INFO "Facsimile: ''FORM_FLD_NFAX'"$ IF "''FORM_FLD_NFAX'" .EQS. "" THEN $ WRITE INFO "Facsimile: [No change]"$ IF "''FORM_FLD_NCOMMENTA'" .NES. "" THEN $ WRITE INFO "Comment 1: ''FORM_FLD_NCOMMENTA'"$ IF "''FORM_FLD_NCOMMENTA'" .EQS. "" THEN $ WRITE INFO "(No comment 1)"$ IF "''FORM_FLD_NCOMMENTB'" .NES. "" THEN $ WRITE INFO "Comment 2: ''FORM_FLD_NCOMMENTB'"$ IF "''FORM_FLD_NCOMMENTB'" .EQS. "" THEN $ WRITE INFO "(No comment 2)"$ WRITE INFO ""$ WRITE INFO "Yours sincerely"$ WRITE INFO ""$ IF "''FORM_FLD_NSURNAME'" .EQS. "" THEN $ WRITE INFO "''FORM_FLD_FIRSTNAME' ''FORM_FLD_SURNAME'"$ IF "''FORM_FLD_NSURNAME'" .NES. "" THEN $ WRITE INFO "''FORM_FLD_FIRSTNAME' ''FORM_FLD_NSURNAME' (previously ''FORM_FLD_SURNAME')"$ WRITE INFO ""$ WRITE INFO "------------------------------------------------------------"$ WRITE INFO "         Note to BCA Administrator from BCA Webmaster       "$ WRITE INFO "------------------------------------------------------------"$ WRITE INFO ""$ WRITE INFO "As a security precaution against fraudulent or malicious use"$ WRITE INFO "of the electronic "Change of Membership Details" form on the"$ WRITE INFO "BCA web site, all email addresses should be checked against"$ WRITE INFO "existing records. For security, any changes that involve a"$ WRITE INFO "change of email address must be verified by phone, fax, or"$ WRITE INFO "letter."$ WRITE INFO ""$ CLOSE/NOLOG INFO$ MAIL/SUBJECT="BCA Membership Update" 'INFOFILE' "bca@glasconf.demon.co.uk,djtaylor@lineone.net"$!$!For test purposes only.$!MAIL/SUBJECT="BCA Membership Update" 'INFOFILE' "cockcroft@img.cryst.bbk.ac.uk"$!$ DELETE/NOLOG 'INFOFILE'$ 10:$ WN "content-type: text/html"$ WN ""$ WN "<HTML>"$ WN "<HEAD>"$ WN "<TITLE>BCA Membership Changes Received OK!</TITLE>"$ WN "</HEAD>"$ WN "<BODY BGCOLOR=#FFFFFF TEXT=#000000 ALINK=#FF0000 LINK=#0000FF VLINK=#AA00FF>"$ WN "<CENTER>"$ WN "<A HREF=""/bca/welcome.htm""><IMG SRC=""/bca/images/bcalogo3.gif"" BORDER=0></A>"$ WN "<P><FONT SIZE=+2><B>BCA Membership Changes</B></FONT><P>"$ WN "Thank you for the time taken to complete this form.<P>"$ WN "You should receive a confirmation email showing the updated information.<P>"$ WN "We will process the information as quickly as possible."$ WN "</CENTER>"$ WN "</BODY>"$ WN "</HTML>"$ OPEN/WRITE INFO 'INFOFILE'$ WRITE INFO ""$ WRITE INFO "Dear BCA Member"$ WRITE INFO ""$ WRITE INFO "This message was generated automatically when you"$ WRITE INFO "updated your BCA membership details via the BCA website."$ WRITE INFO "Items marked compulsory are indicated by (*)."$ WRITE INFO ""$ WRITE INFO "If any errors are seen in this submission, please contact"$ WRITE INFO "the BCA Administrative Office and/or BCA Webmaster."$ WRITE INFO ""$ WRITE INFO "EXISTING DETAILS"$ WRITE INFO "First name: (*) ''FORM_FLD_FIRSTNAME'"$ WRITE INFO "Initials: (*) ''FORM_FLD_INITIALS'"$ WRITE INFO "Surname: (*) ''FORM_FLD_SURNAME'"$ IF "''FORM_FLD_MEMBERNO'" .NES. "" THEN $ WRITE INFO "Membership No.: ''FORM_FLD_MEMBERNO'"$ IF "''FORM_FLD_MEMBERNO'" .EQS. "" THEN $ WRITE INFO "Membership No.: Not Known"$ WRITE INFO ""$ WRITE INFO "EXISTING/NEW DETAILS"$ WRITE INFO "E-mail address: (*) ''FORM_FLD_EMAIL'"$ WRITE INFO ""$ WRITE INFO "NEW DETAILS"$ IF "''FORM_FLD_NTITLE'" .NES. "" THEN $ WRITE INFO "Title: ''FORM_FLD_NTITLE'"$ IF "''FORM_FLD_NTITLE'" .EQS. "" THEN $ WRITE INFO "Title: [No change)"$ IF "''FORM_FLD_NSURNAME'" .NES. "" THEN $ WRITE INFO "Surname: ''FORM_FLD_NSURNAME'"$ IF "''FORM_FLD_NSURNAME'" .EQS. "" THEN $ WRITE INFO "Surname: [No change]"$ IF "''FORM_FLD_NDEPART'" .NES. "" THEN $ WRITE INFO "Department: ''FORM_FLD_NDEPART'"$ IF "''FORM_FLD_NDEPART'" .EQS. "" THEN $ WRITE INFO "Department: [No change]"$ IF "''FORM_FLD_NINSTITUTE'" .NES. "" THEN $ WRITE INFO "Institution: ''FORM_FLD_NINSTITUTE'"$ IF "''FORM_FLD_NINSTITUTE'" .EQS. "" THEN $ WRITE INFO "Institution: [No change]"$ IF "''FORM_FLD_NBUILDING'" .NES. "" THEN $ WRITE INFO "Address (building): ''FORM_FLD_NBUILDING'"$ IF "''FORM_FLD_NBUILDING'" .EQS. "" THEN $ WRITE INFO "Address (building): [No change]"$ IF "''FORM_FLD_NSTREET'" .NES. "" THEN $ WRITE INFO "Address (street): ''FORM_FLD_NSTREET'"$ IF "''FORM_FLD_NSTREET'" .EQS. "" THEN $ WRITE INFO "Address (street): [No change]"$ IF "''FORM_FLD_NTOWN'" .NES. "" THEN $ WRITE INFO "Address (town): ''FORM_FLD_NTOWN'"$ IF "''FORM_FLD_NTOWN'" .EQS. "" THEN $ WRITE INFO "Address (town): [No change]"$ IF "''FORM_FLD_NCOUNTY'" .NES. "" THEN $ WRITE INFO "Address (county/state): ''FORM_FLD_NCOUNTY'"$ IF "''FORM_FLD_NCOUNTY'" .EQS. "" THEN $ WRITE INFO "Address (county/state): [No change]"$ IF "''FORM_FLD_NCOUNTRY'" .NES. "" THEN $ WRITE INFO "Address (country): ''FORM_FLD_NCOUNTRY'"$ IF "''FORM_FLD_NCOUNTRY'" .EQS. "" THEN $ WRITE INFO "Address (country): [No change]"$ IF "''FORM_FLD_NZIP'" .NES. "" THEN $ WRITE INFO "Address (post/zip code): ''FORM_FLD_NZIP'"$ IF "''FORM_FLD_NZIP'" .EQS. "" THEN $ WRITE INFO "Address (post/zip code): [No change]"$ IF "''FORM_FLD_NPHONE'" .NES. "" THEN $ WRITE INFO "Telephone: ''FORM_FLD_NPHONE'"$ IF "''FORM_FLD_NPHONE'" .EQS. "" THEN $ WRITE INFO "Telephone: [No change]"$ IF "''FORM_FLD_NFAX'" .NES. "" THEN $ WRITE INFO "Facsimile: ''FORM_FLD_NFAX'"$ IF "''FORM_FLD_NFAX'" .EQS. "" THEN $ WRITE INFO "Facsimile: [No change]"$ IF "''FORM_FLD_NCOMMENTA'" .NES. "" THEN $ WRITE INFO "Comment 1: ''FORM_FLD_NCOMMENTA'"$ IF "''FORM_FLD_NCOMMENTA'" .EQS. "" THEN $ WRITE INFO "(No comment 1)"$ IF "''FORM_FLD_NCOMMENTB'" .NES. "" THEN $ WRITE INFO "Comment 2: ''FORM_FLD_NCOMMENTB'"$ IF "''FORM_FLD_NCOMMENTB'" .EQS. "" THEN $ WRITE INFO "(No comment 2)"$ WRITE INFO ""$ WRITE INFO "Yours sincerely"$ WRITE INFO ""$ WRITE INFO "BCA Webmaster"$ WRITE INFO ""$ WRITE INFO ""$ WRITE INFO "N.B. Do not use REPLY to this email address"$ WRITE INFO ""$ CLOSE/NOLOG INFO$ ON ERROR THEN $ CONTINUE$ MAIL/SUBJECT="BCA Membership Update" 'INFOFILE' "''FORM_FLD_EMAIL'"$ DELETE/NOLOG 'INFOFILE'$ EXIT$ 20:$ WN "content-type: text/html"$ WN ""$ WN "<HTML>"$ WN "<HEAD>"$ WN "<TITLE>BCA Membership Changes NOT Updated!</TITLE>"$ WN "</HEAD>"$ WN "<BODY BGCOLOR=#FFFFFF TEXT=#000000 ALINK=#FF0000 LINK=#0000FF VLINK=#AA00FF>"$ WN "<CENTER>"$ WN "<A HREF=""/bca/welcome.htm""><IMG SRC=""/bca/images/bcalogo3.gif"" BORDER=0></A>"$ WN "<P><FONT SIZE=+2><B>BCA Membership Changes <I>NOT</I> Updated!</B></FONT><P>"$ WN "Sorry, but you failed to fill in the form correctly.<P>"$ WN "Use the back button on your browser to return to the form.<P>"$ WN "Please make sure that you complete all items marked with an "$ WN "<FONT COLOR=#FF0000>*</FONT> correctly."$ WN "</CENTER>"$ WN "</BODY>"$ WN "</HTML>"$ EXIT