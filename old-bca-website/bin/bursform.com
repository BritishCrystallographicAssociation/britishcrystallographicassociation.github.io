$ WN := WRITE NET_LINK$ WN "<DNETRECMODE>"$ INP := $WWW_ROOT:[BIN]CGI_SYMBOLS$ INP WWW_ FORM_$! Get date in nice format.$ TIME = F$TIME()$ DAT = F$EXTRACT(0,2,TIME)$ MON = F$EXTRACT(3,3,TIME)$ IF "''MON'" .EQS. "JAN" THEN $ MON = "January"$ IF "''MON'" .EQS. "FEB" THEN $ MON = "February"$ IF "''MON'" .EQS. "MAR" THEN $ MON = "March"$ IF "''MON'" .EQS. "APR" THEN $ MON = "April"$ IF "''MON'" .EQS. "MAY" THEN $ MON = "May"$ IF "''MON'" .EQS. "JUN" THEN $ MON = "June"$ IF "''MON'" .EQS. "JUL" THEN $ MON = "July"$ IF "''MON'" .EQS. "AUG" THEN $ MON = "August"$ IF "''MON'" .EQS. "SEP" THEN $ MON = "September"$ IF "''MON'" .EQS. "OCT" THEN $ MON = "October"$ IF "''MON'" .EQS. "NOV" THEN $ MON = "November"$ IF "''MON'" .EQS. "DEC" THEN $ MON = "December"$ YEAR = F$EXTRACT(7,4,TIME)$ TODAY = DAT + " " + MON + " " + YEAR$! Get temporary filename based on date & time.$ INFOFILE = "DKUSER3:[WWW]" + F$EXTRACT(0,2,TIME) + F$EXTRACT(12,2,TIME) - + F$EXTRACT(15,2,TIME) + F$EXTRACT(18,2,TIME) + F$EXTRACT(21,2,TIME) + ".DAT;1"$ INFOFILE := 'F$EDIT(INFOFILE,"COLLAPSE")'$ NERR = 0$! Check most important fields only...$ IF "''FORM_FLD_TITLE'" .EQS. "" THEN $ NERR = NERR + 1$ IF "''FORM_FLD_FIRSTNAME'" .EQS. "" THEN $ NERR = NERR + 1$ IF "''FORM_FLD_SURNAME'" .EQS. "" THEN $ NERR = NERR + 1$ IF "''FORM_FLD_EMAIL'" .EQS. "" THEN $ NERR = NERR + 1$ IF "''FORM_FLD_NSTREET'" .EQS. "" THEN $ NERR = NERR + 1$ IF "''FORM_FLD_NTOWN'" .EQS. "" THEN $ NERR = NERR + 1$ IF "''FORM_FLD_NCOUNTRY'" .EQS. "" THEN $ NERR = NERR + 1$ IF "''FORM_FLD_NZIP'" .EQS. "" THEN $ NERR = NERR + 1$ IF "''FORM_FLD_NPHONE'" .EQS. "" THEN $ NERR = NERR + 1$ IF "''FORM_FLD_JOB'" .EQS. "" THEN $ NERR = NERR + 1$ IF "''FORM_FLD_FINSUP'" .EQS. "" THEN $ NERR = NERR + 1$ IF "''FORM_FLD_JOINYEAR'" .EQS. "" THEN $ NERR = NERR + 1$ IF "''FORM_FLD_MEMNUM'" .EQS. "" THEN $ NERR = NERR + 1$ IF "''FORM_FLD_MEETING'" .EQS. "" THEN $ NERR = NERR + 1$ IF "''FORM_FLD_PLACE'" .EQS. "" THEN $ NERR = NERR + 1$ IF "''FORM_FLD_DATES'" .EQS. "" THEN $ NERR = NERR + 1$ IF "''FORM_FLD_DECDATE'" .EQS. "" THEN $ NERR = NERR + 1$ IF "''FORM_FLD_BENYOU'" .EQS. "" THEN $ NERR = NERR + 1$ IF "''FORM_FLD_BENHOST'" .EQS. "" THEN $ NERR = NERR + 1$ IF "''FORM_FLD_BENHOME'" .EQS. "" THEN $ NERR = NERR + 1$ IF "''FORM_FLD_COSTBUS'" .EQS. "" THEN $ NERR = NERR + 1$ IF "''FORM_FLD_COSTSUB'" .EQS. "" THEN $ NERR = NERR + 1$ IF "''FORM_FLD_COSTREG'" .EQS. "" THEN $ NERR = NERR + 1$ IF "''FORM_FLD_COSTALL'" .EQS. "" THEN $ NERR = NERR + 1$ IF "''FORM_FLD_FUNDSIN'" .EQS. "" THEN $ NERR = NERR + 1$ IF "''FORM_FLD_FUNDSGT'" .EQS. "" THEN $ NERR = NERR + 1$ IF "''FORM_FLD_CASHLR'" .EQS. "" THEN $ NERR = NERR + 1$ IF "''FORM_FLD_SVISORENAME'" .EQS. "" THEN $ NERR = NERR + 1$ IF "''FORM_FLD_SVISOREMAIL'" .EQS. "" THEN $ NERR = NERR + 1$ IF "''FORM_FLD_CHEQUE'" .EQS. "" THEN $ NERR = NERR + 1$ IF NERR .NE. 0 THEN $ GOTO 20$! Get application number.$ OPEN/READ ICOUNT ABBF-NO.TXT$ READ ICOUNT REGNO$ CLOSE/NOLOG ICOUNT$ REGNO = 'REGNO' + 1$ OPEN/WRITE ICOUNT ABBF-NO.TXT$ WRITE ICOUNT 'REGNO'$ CLOSE/NOLOG ICOUNT$ PURGE/NOLOG ABBF-NO.TXT$ RENAME ABBF-NO.TXT ABBF-NO.TXT;1$!$ OPEN/WRITE INFO 'INFOFILE'$ W := WRITE INFO$ W ""$ W " *** DO NOT USE REPLY TO THIS EMAIL ADDRESS ***"$ W ""$ W "**********************************************************"$ W "ELECTRONIC APPLICATION for BCA ARNOLD BEEVERS BURSARY FUND"$ W "**********************************************************"$ W ""$ W "APPLICATION NUMBER: # ''REGNO'"$ W ""$ W "APPLICATION DATE: ''TODAY'"$ W ""$ W "APPLICANTS DETAILS"$ W "Title:      ''FORM_FLD_TITLE'"$ W "First Name: ''FORM_FLD_FIRSTNAME'"$ W "Initials:   ''FORM_FLD_INITIALS'"$ W "Surname:    ''FORM_FLD_SURNAME'"$ W "E-mail:     ''FORM_FLD_EMAIL'"$ W ""$ W "POSTAL DETAILS"$ W "Department:          ''FORM_FLD_NDEPART'"$ W "Institution:         ''FORM_FLD_NINSTITUTE'"$ W "Address (building):  ''FORM_FLD_NBUILDING'"$ W "Address (street):    ''FORM_FLD_NSTREET'"$ W "Address (town):      ''FORM_FLD_NTOWN'"$ W "Address (county):    ''FORM_FLD_NCOUNTY'"$ W "Address (country):   ''FORM_FLD_NCOUNTRY'"$ W "Address (post code): ''FORM_FLD_NZIP'"$ W "Telephone:           ''FORM_FLD_NPHONE'"$ W "Fax:                 ''FORM_FLD_NFAX'"$ W ""$ W "APPLICANTS INFORMATION"$ W "Present Position:                   ''FORM_FLD_JOB'"$ W "Present Means of Financial Support: ''FORM_FLD_FINSUP'"$ W "Date of Joining BCA:                ''FORM_FLD_JOINYEAR' ''FORM_FLD_JOINMONTH'"$ W "BCA Membership Number:              ''FORM_FLD_MEMNUM'"$ W "Previous BCA Bursary Applicant:     ''FORM_FLD_PREVAPP'"$ IF "''FORM_FLD_PREVAPP'" .EQS. "NO" THEN $ GOTO 10$ IF "''FORM_FLD_SMEET'" .NES. "" THEN $ -  W "   Spring Meeting Bursary:          ''FORM_FLD_SMDATE'"$ IF "''FORM_FLD_GENERAL'" .NES. "" THEN $ -$ W "   General Bursary:                 ''FORM_FLD_GENDATE'"$ 10:$ W "BCA Spring Meeting Attendance(s):   ''FORM_FLD_SMATND'"$ W "BCA Group Meeting Attendance(s):    ''FORM_FLD_GRPATND'"$ W ""$ W "PROPOSED MEETING DETAILS"$ W "Meeting (or Visit) to be Attended:   ''FORM_FLD_MEETING'"$ W "Meeting Web Site:                    ''FORM_FLD_MEETINGWWW'"$ W "Place of Meeting (or Visit):         ''FORM_FLD_PLACE'"$ W "Date(s) of Meeting (or Visit):       ''FORM_FLD_DATES'"$ W "Date needed for Funding Decision:    ''FORM_FLD_DECDATE'"$ W ""$ W "VALUE TO:"$ W "(a) Scientific career:"$ W "''FORM_FLD_BENYOU'"$ W "(b) Conference (or Host Institution):"$ W "''FORM_FLD_BENHOST'"$ W "(c) Home laboratory:"$ W "''FORM_FLD_BENHOME'"$ W ""$ W "ESTIMATED COSTS (in GBP):"$ W "(a) Travel:       ''FORM_FLD_COSTBUS'"$ W "(b) Subsistence:  ''FORM_FLD_COSTSUB'"$ W "(c) Registration: ''FORM_FLD_COSTREG'"$ W "(d) Total Amount: ''FORM_FLD_COSTALL'"$ W ""$ W "OTHER SOURCES OF SUPPORT:"$ W "(a) Funds in place: ''FORM_FLD_FUNDSIN' (from ''FORM_FLD_CASHSRC')"$ W "(b) Funds sought:   ''FORM_FLD_FUNDSGT' (from ''FORM_FLD_CASHSGT')"$ W "(c) Last resort?:   ''FORM_FLD_CASHLR'"$ W ""$ W "SUPERVISOR (or HEAD OF DEPARTMENT) CONTACT DETAILS"$ W "Supervisor's (or HoD) Name:   ''FORM_FLD_SVISORENAME'"$ W "Supervisor's (or HoD) E-mail: ''FORM_FLD_SVISOREMAIL'"$ W ""$ W "FURTHER DETAILS (if any)"$ W "''FORM_FLD_COMENT"$ W ""$ W "IF SUCCESSFUL: Cheque payable to ''FORM_FLD_CHEQUE'"$ W ""$ W "                *** END OF APPLICATION *** ""$ W ""$ CLOSE/NOLOG INFO$ ON ERROR THEN $ CONTINUE$ MAIL/SUBJECT="Arnold Beevers Bursary Fund Application" 'INFOFILE' "''FORM_FLD_EMAIL'"$! Email BCA Treasurer.$ MAIL/SUBJECT="Arnold Beevers Bursary Fund Application" 'INFOFILE' "bmmu@ed.ac.uk"$! Get temporary filename based on date & time.$ BCAFILE = "DKUSER3:[WWW]BCA" + F$EXTRACT(0,2,TIME) + F$EXTRACT(12,2,TIME) - + F$EXTRACT(15,2,TIME) + F$EXTRACT(18,2,TIME) + F$EXTRACT(21,2,TIME) + ".DAT;1"$ BCAFILE := 'F$EDIT(BCAFILE,"COLLAPSE")'$ OPEN/WRITE INFO 'BCAFILE'$ W "Dear BCA Administrator"$ W ""$ W "The following is an electronic application for an Arnold Beevers Bursary"$ W "Please check that the membership details (including no.) on the form are"$ W "correct and inform the BCA Treasurer. Also store paper and electronic"$ W "copies of the email safely for as a backup. A copy of the application is"$ W "also sent to the BCA Treasurer."$ W ""$ W "The BCA Treasurer will send an E-mail to the nominated supervisor and "$ W "when a reply is received, the application will be distributed to the"$ W "the Bursary committee. Once a decision is made you will be notified and"$ W "will be sent a cheque for distribution with the bursary pack."$ W ""$ W "BCA Webmaster (on behalf of the BCA Treasurer)"$ CLOSE/NOLOG INFO$ APPEND 'INFOFILE' 'BCAFILE'$ MAIL/SUBJECT="Arnold Beevers Bursary Fund Application" 'BCAFILE' "bca@glasconf.demon.co.uk"$ DELETE/NOLOG 'BCAFILE'$ DELETE/NOLOG 'INFOFILE'$!$ WN "content-type: text/html"$ WN ""$ WN "<HTML>"$ WN "<HEAD>"$ WN "<TITLE>Arnold Beevers Bursary Fund: Application Received OK!</TITLE>"$ WN "</HEAD>"$ WN "<BODY BGCOLOR=#FFFFFF TEXT=#000000 ALINK=#FF0000 LINK=#0000FF VLINK=#AA00FF>"$ WN "<CENTER>"$ WN "<A HREF=""/bca/welcome.htm""><IMG SRC=""/bca/images/bcalogo3.gif"" BORDER=0></A>"$ WN "<P><FONT SIZE=+2><B>Arnold Beevers Bursary Fund Application</B></FONT>"$ WN "<P>Thank you for the time taken to complete this form."$ WN "<P>You should receive a confirmation email containing a copy of the submitted details."$ WN "<P>The bursary committee will process the application as quickly as possible."$ WN "</CENTER>"$ WN "</BODY>"$ WN "</HTML>"$ EXIT$ 20:$ WN "content-type: text/html"$ WN ""$ WN "<HTML>"$ WN "<HEAD>"$ WN "<TITLE>Arnold Beevers Bursary Fund: Application Faulty!</TITLE>"$ WN "</HEAD>"$ WN "<BODY BGCOLOR=#FFFFFF TEXT=#000000 ALINK=#FF0000 LINK=#0000FF VLINK=#AA00FF>"$ WN "<CENTER>"$ WN "<A HREF=""/bca/welcome.htm""><IMG SRC=""/bca/images/bcalogo3.gif"" BORDER=0></A>"$ WN "<P><FONT SIZE=+2><B>Arnold Beevers Bursary Fund Application</B></FONT><P>"$ WN "Sorry, but you failed to fill in the form correctly.<P>"$ WN "Use the back button on your browser to return to the form.<P>"$ WN "Please make sure that you complete all items marked with an "$ WN "<FONT COLOR=#FF0000>*</FONT> correctly."$ WN "</CENTER>"$ WN "</BODY>"$ WN "</HTML>"$ EXIT